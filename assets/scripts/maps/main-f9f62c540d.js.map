{"version":3,"sources":["app/assets/scripts/main.js"],"names":["getPrimaryStats","countryId","url","$","getJSON","countryData","all_edits","usersCount","Math","round","contributors","editsCount","buildingCount","building_count_add","roadCount","road_count_add","html","toLocaleString","css","getProjects","projects","flexslider","animation","directionNav","slideshowSpeed","prevText","nextText","prependTo","length","forEach","project","i","projectData","makeProject","fail","err","makePlaceholderProject","projectOrder","projDone","percentMapped","addClass","append","projectId","name","attr","addMap","ghIssueTitle","PT","mainHashtag","ghIssueBody","errorHtml","empty","onEachFeature","feature","layer","symbology","color","weight","opacity","fillOpacity","fillColor","taskStatus","properties","setStyle","endpoint","taskData","map","L","zoomControl","setView","tileLayer","mbBasemapUrl","mbToken","attribution","addTo","attributionControl","setPrefix","featureLayer","geoJson","tasks","fitBounds","getBounds","dragging","disable","touchZoom","doubleClickZoom","scrollWheelZoom","keyboard","tap","eventsFunctionality","eventsCount","firstTwoOpen","allOpen","bind","click","event","slice","animate","height","generateEvents","calendarId","match","currentDate","Date","eventData","linkMatch","Object","keys","reverse","key","val","eventTime","time","moment","isBefore","title","singupLink","description","desc","replace","location","date","format","d","join","eventTopSection","flag","eventMainDetails","eventsHTML","setupGraphs","removeExistingGraphs","totalGraph","document","querySelector","bldngGraph","roadsGraph","parentNode","removeChild","teamLabel","teamUserLabel","removeClass","text","getUserActivityStats","iso3","getGroupActivityStats","showMoreContributions","generateUserUrl","userName","userUrl","toLowerCase","userData","totalSum","user","totalEdits","Number","value","sort","a","b","bldngSum","bldngEdits","roadsSum","roadsEdits","road_km_add","c1","Barchart","c2","c3","moreBtn","d3","select","window","on","resize","generateHashtagUrl","hashtag","hashtagUrl","hashtagData","reduce","acc","ht","isEmptyObject","sum","push","building_count_mod","data","targetElement","margin","top","right","bottom","left","width","parseInt","style","barPadding","barHeight","offset","expanded","graphs","marginTop","x","scale","linear","range","domain","max","chart","node","bars","selectAll","enter","this","showUpdatesPlaceholder","makeValidation","userList","users","_","uniqBy","features","mappercount","output","uid","id","create","modify","getDate","today","dd","mm","getMonth","yyyy","getFullYear","getValidation","bbox","bbx","split","valDate","console","warn","hotProjects","calendar"],"mappings":"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","file":"main-f9f62c540d.js","sourcesContent":["/* jshint esversion: 6 */\n\n/* -------------------------------------------------------\n------------------- Add Primary Stats -------------------\n-------------------------------------------------------*/\n\nfunction getPrimaryStats(countryId) {\n  const url = `https://osm-stats-production-api.azurewebsites.net/countries/${countryId}`;\n  $.getJSON(url, function(countryData) {\n    if (countryData.all_edits !== null) {\n      // round value for select stats, then add them to page\n      const usersCount = Math.round(countryData.contributors);\n      const editsCount = Math.round(countryData.all_edits);\n      const buildingCount = Math.round(countryData.building_count_add);\n      const roadCount = Math.round(countryData.road_count_add);\n\n      $(\"#stats-roadCount\").html(roadCount.toLocaleString());\n      $(\"#stats-buildingCount\").html(buildingCount.toLocaleString());\n      $(\"#stats-usersCount\").html(usersCount.toLocaleString());\n      $(\"#stats-editsCount\").html(editsCount.toLocaleString());\n    } else {\n      $(\".emphasizedNumber\").css(\"display\", \"none\");\n    }\n  });\n}\n\n/* -------------------------------------------------------\n --------------- Add HOT Project Carousel ----------------\n -------------------------------------------------------*/\n\n// Fetch Project data from Tasking Manager API\nfunction getProjects(projects) {\n  // Add Flexslider to Projects Section\n  $(\".Projects-slider\").flexslider({\n    animation: \"slide\",\n    directionNav: true,\n    slideshowSpeed: 6000000,\n    prevText: \"\",\n    nextText: \"\"\n  });\n  $(\".flex-next\").prependTo(\".HOT-Nav-Projects\");\n  $(\".flex-control-nav\").prependTo(\".HOT-Nav-Projects\");\n  $(\".flex-prev\").prependTo(\".HOT-Nav-Projects\");\n\n  if (projects.length === 1) {\n    $(\".flex-next\").css(\"display\", \"none\");\n  }\n\n  projects.forEach(function(project, i) {\n    const url = `https://tasks.hotosm.org/api/v1/project/${project}/summary`;\n    $.getJSON(url, function(projectData) {\n      makeProject(projectData, i + 2);\n    }).fail(function(err) {\n      // console.log(`WARNING >> Project #${project} could not be accessed at ${url}.\\n` +\n      //              `The server returned the following message object:`, err);\n      makePlaceholderProject(project, i + 2);\n    });\n  });\n}\n\n// Update cards with necessary project details\nfunction makeProject(project, projectOrder) {\n  const projDone = Math.round(project.percentMapped);\n\n  // Updates Progress Bar\n  $(`ul li:nth-child(${projectOrder}) .HOT-Progress`).addClass(\n    \"projWidth\" + projectOrder\n  );\n  $(\".HOT-Progress\").append(\n    `<style>.projWidth${projectOrder}:before{ width: ${projDone}%;}</style>`\n  );\n\n  // Adds Project variables to the cards\n  $(`ul li:nth-child(${projectOrder}) .HOT-Title p`).html(\n    `<b>${project.projectId} - ${project.name}</b>`\n  );\n  $(`ul li:nth-child(${projectOrder}) .title`).html(\n    `${project.name} (#${project.projectId})`\n  );\n  $(`ul li:nth-child(${projectOrder}) .HOT-Progress`).html(\n    `<p>${projDone}%</p>`\n  );\n  $(`ul li:nth-child(${projectOrder}) .HOT-Progress`).attr(\n    \"title\",\n    `${projDone}% complete`\n  );\n  $(`ul li:nth-child(${projectOrder}) .HOT-Details .completeness`).html(\n    `<strong>${projDone}%</strong> complete`\n  );\n  $(`ul li:nth-child(${projectOrder}) .HOT-Map`).attr(\n    \"id\",\n    \"Map-\" + project.projectId\n  );\n\n  // Drop a map into the HOT-Map div\n  addMap(project.projectId);\n}\n\n// Adds placeholder/ warning formatting to project carousel entry in the event\n// that a project cannot be retrieved from the HOT Tasking Manager API\nfunction makePlaceholderProject(projectId, projectOrder) {\n  // Adds error title\n  $(`ul li:nth-child(${projectOrder}) .HOT-Title p`)\n    .html(`<i class=\"ico icon collecticon-sign-danger\"></i>\n<b>HOT Project #${projectId} Not Active/Not Found in HOT Tasking Manager</b>`);\n\n  // Hides Tasking Manager Contribute button\n  $(\"#TM-Contribute-Btn-\" + projectId).css(\"display\", \"none\");\n  $(`#HOT-Title-${projectId} p`).css(\"width\", \"100%\");\n\n  // Generate issue information for Github tracker\n  const ghIssueTitle = `HOT Tasking Manager endpoint failure in ${PT.mainHashtag} partner page`;\n  const ghIssueBody = `Project ${projectId} is no longer indexed in the HOT\n Tasking Manager, so it should be removed from the ${PT.mainHashtag} partner\n page variable settings.`;\n\n  // Add explanatory error text\n  const errorHtml = `Uh oh, it looks like <a href=\"https://tasks.hotosm.org/api/v1/project/${project};${projectId}\"\n target=\"_blank\">Project #${projectId}</a> has been removed from the HOT Tasking Manager.\n <a href=\"https://github.com/MissingMaps/partners/issues/new?title=${ghIssueTitle}\n &body=${ghIssueBody}\" target=\"_blank\">Click here</a> to report an issue or\n <a href=\"https://tasks.hotosm.org/\" target=\"_blank\">here</a>\n to search for more projects.`;\n\n  $(`ul li:nth-child(${projectOrder}) .HOT-Description p`).html(errorHtml);\n\n  // Remove loading spinners and add placeholder background\n  $(`ul li:nth-child(${projectOrder}) .HOT-Map`)\n    .empty()\n    .addClass(\"placeholder\");\n  $(`ul li:nth-child(${projectOrder}) .HOT-Progress `).css(\"display\", \"none\");\n}\n\n/* -------------------------------------------------------\n ----------- Add Map to HOT Project Carousel -------------\n -------------------------------------------------------*/\n\nfunction onEachFeature(feature, layer) {\n  // Set symbology to match HOTOSM Tasking Manager completion states\n  let symbology = {\n    color: \"black\",\n    weight: 0.25,\n    opacity: 0.7,\n    fillOpacity: 0.4,\n    fillColor: \"black\"\n  };\n\n  const taskStatus = feature.properties.taskStatus;\n  if (taskStatus === \"READY\") {\n    symbology.fillColor = \"#ffffff\"; //white\n    symbology.fillOpacity = 0.0; //transparent\n  } else if (taskStatus === \"INVALIDATED\") {\n    symbology.fillColor = \"#e90b43\"; //red\n  } else if (taskStatus === \"VALIDATED\") {\n    symbology.fillColor = \"#008000\"; //green\n  } else if (taskStatus === \"LOCKED_FOR_MAPPING\") {\n    symbology.fillColor = \"#1259F0\"; //blue\n  } else if (taskStatus === \"MAPPED\") {\n    symbology.fillColor = \"#ffcc00\"; //yellow\n  }\n\n  layer.setStyle(symbology);\n}\n\nfunction addMap(projectId) {\n  // Connect HOT-OSM endpoint for tasking squares data\n  const endpoint = `https://tasks.hotosm.org/api/v1/project/${projectId}`;\n  $.getJSON(endpoint, function(taskData) {\n    // Remove loading spinners before placing map\n    $(\"#Map-\" + projectId).empty();\n\n    // Initialize map\n    const map = L.map(\"Map-\" + projectId, { zoomControl: false }).setView(\n      [38.889931, -77.009003],\n      13\n    );\n\n    // Add tile layer\n    L.tileLayer(mbBasemapUrl + \"?access_token=\" + mbToken, {\n      attribution: '<a href=\"http://mapbox.com\">Mapbox</a>'\n    }).addTo(map);\n\n    // Remove 'Leaflet' attribution\n    map.attributionControl.setPrefix(\"\");\n\n    // Add feature layer\n    const featureLayer = L.geoJson(taskData.tasks, {\n      onEachFeature: onEachFeature\n    }).addTo(map);\n\n    // Fit to feature layer bounds\n    map.fitBounds(featureLayer.getBounds());\n\n    // Disable drag and zoom handlers\n    map.dragging.disable();\n    map.touchZoom.disable();\n    map.doubleClickZoom.disable();\n    map.scrollWheelZoom.disable();\n    map.keyboard.disable();\n    if (map.tap) map.tap.disable();\n  });\n}\n\n/* -------------------------------------------------------\n  ----------- Add Functionality to Events List  -----------\n  -------------------------------------------------------*/\n\n// Adds hide/ show functionality to events list (pre-generated by Jekyll)\nfunction eventsFunctionality() {\n  const eventsCount = $(\".event-sub-container\").length;\n  var firstTwoOpen = false;\n  var allOpen = false;\n\n  if (eventsCount <= 3) {\n    $(\".events-btn\").css(\"display\", \"none\");\n  }\n\n  $(\".events-btn\")\n    .bind(\"click\")\n    .click(function(event) {\n      if (firstTwoOpen === false && allOpen === false) {\n        firstTwoOpen = true;\n        $(\".hidden\")\n          .slice(0, 2)\n          .css(\"display\", \"block\")\n          .animate(\n            {\n              opacity: 1,\n              height: \"190px\"\n            },\n            500\n          );\n        if (eventsCount >= 5) {\n          $(\".events-btn\").html(\"SEE ALL\");\n        } else {\n          firstTwoOpen = false;\n          allOpen = true;\n          $(\".events-btn\").html(\"SEE FEWER\");\n        }\n      } else if (\n        firstTwoOpen === true &&\n        allOpen === false &&\n        eventsCount > 2\n      ) {\n        firstTwoOpen = false;\n        allOpen = true;\n        $(\".events-btn\").html(\"SEE ALL\");\n        $(\".hidden\")\n          .css(\"display\", \"block\")\n          .animate(\n            {\n              opacity: 1,\n              height: \"190px\"\n            },\n            500\n          );\n        $(\".events-btn\").html(\"SEE FEWER\");\n      } else if (firstTwoOpen === false && allOpen === true) {\n        firstTwoOpen = false;\n        allOpen = false;\n        $(\".hidden\").animate(\n          {\n            opacity: 0,\n            height: \"0px\"\n          },\n          300,\n          function() {\n            $(\".hidden\").css(\"display\", \"none\");\n          }\n        );\n        $(\".events-btn\").html(\"SEE MORE\");\n      }\n    });\n}\n\n/* -------------------------------------------------------\n  -------------------- Add Events Cards -------------------\n  -------------------------------------------------------*/\n\nfunction generateEvents(calendarId) {\n  if (calendarId.match(/google/)) {\n    $(\"#events-spinner\").css(\"display\", \"block\");\n    const url =\n      \"https://osm-stats-production-api.azurewebsites.net/calendar/\" +\n      calendarId +\n      \"/events\";\n    const currentDate = new Date();\n    $.getJSON(url, eventData => {\n      if (eventData.length === 0) {\n        $(\".events-null\").css(\"display\", \"block\");\n        $(\".events-panel\").css(\"display\", \"none\");\n      } else {\n        let linkMatch = /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/gi;\n        // console.log(eventData);\n        Object.keys(eventData)\n          .reverse()\n          .map((key, val) => {\n            const eventTime = eventData[key].time[0];\n            if (moment(currentDate).isBefore(eventTime)) {\n              const title = eventData[key].name;\n              const singupLink = eventData[key].description.match(linkMatch);\n              const desc = eventData[key].description.replace(linkMatch, \"\");\n              const location = eventData[key].location;\n              const date = moment(eventData[key].time[0]).format(\"MMMM Do\");\n              const time = eventData[key].time\n                .map(d => {\n                  const date = new Date(d);\n                  return moment(date).format(\"h:mma\");\n                })\n                .join(\" - \");\n              const eventTopSection = [\n                '<div class=\"card-divider event-top-section\">',\n                '<div class=\"sub-head\">',\n                '<img class=\"event-images\" src=\"/assets/graphics/flags/4x3/' +\n                  PT.flag +\n                  '\" width=\"24\"/>',\n                '<h3 class=\"event-header\">' + title + \"</h3>\",\n                '<a class=\"btn btn-grn\" href=' +\n                  singupLink +\n                  ' target=\"\">SIGN UP</a>',\n                \"</div>\",\n                \"</div>\"\n              ].join(\"\");\n              const eventMainDetails = [\n                '<div class=\"textbox\" style=\"padding-top:8px\">',\n                \"<p>\" + \"<b>Date:</b> \" + date + \"</p>\",\n                \"<p>\" + \"<b>Time:</b> \" + time + \"</p>\",\n                \"<p>\" + \"<b>Location:</b> \" + location + \"</p>\",\n                \"<p>\" + \"<b>About:</b> \" + desc + \"</p>\",\n                \"</div>\"\n              ].join(\"\");\n              const eventsHTML = [\n                '<div class=\"column\">',\n                '<div class=\"card\">',\n                eventTopSection,\n                '<div class=\"card-section\">',\n                eventMainDetails,\n                \"</div>\",\n                \"</div>\",\n                \"</div>\"\n              ].join(\"\");\n              $(\"#event-cards\").append(eventsHTML);\n              $(\"#events-spinner\").css(\"display\", \"none\");\n            }\n          });\n      }\n    });\n  } else {\n    $(\".events-null\").css(\"display\", \"block\");\n    $(\".events-panel\").css(\"display\", \"none\");\n  }\n  eventsFunctionality();\n}\n\n/* -------------------------------------------------------\n  ------------------ Add Activity Graphs ------------------\n  -------------------------------------------------------*/\n\nfunction setupGraphs() {\n  function removeExistingGraphs() {\n    const totalGraph = document.querySelector(\"#Team-User-Total-Graph svg\");\n    const bldngGraph = document.querySelector(\"#Team-User-Bldng-Graph svg\");\n    const roadsGraph = document.querySelector(\"#Team-User-Roads-Graph svg\");\n    totalGraph.parentNode.removeChild(totalGraph);\n    bldngGraph.parentNode.removeChild(bldngGraph);\n    roadsGraph.parentNode.removeChild(roadsGraph);\n  }\n  const moreBtn = $(\".btn.invert-btn-grn.teams-btn\");\n  const teamLabel = $(\".Team-Graph-Title .left\");\n  const teamUserLabel = $(\".Team-User-Graph-Title .left\");\n\n  // Sets Users button to Selected, loads Users graphs, hides\n  // \"Show More Teams\" button\n  $(\"#Select-Users-Graph\").click(function() {\n    $(\"#Select-Teams-Graph\").removeClass(\"Selected\");\n    $(\"#Select-Users-Graph\").addClass(\"Selected\");\n    teamLabel.text(\"Users\");\n    teamUserLabel.text(\"Users\");\n    // Remove existing graphs\n    removeExistingGraphs();\n    // Gets main hashtag on each partner page via team.html\n    getUserActivityStats(PT.iso3);\n  });\n\n  // Sets Teams button to Selected, loads Teams graphs, reveals\n  // \"Show More Teams\" button if applicable\n  $(\"#Select-Teams-Graph\").click(function() {\n    $(\"#Select-Users-Graph\").removeClass(\"Selected\");\n    $(\"#Select-Teams-Graph\").addClass(\"Selected\");\n    teamLabel.text(\"Teams\");\n    teamUserLabel.text(\"Teams\");\n    // if (PT.subHashtags.length > 10) {\n    //   moreBtn.css('display', 'inline').animate({opacity: 1}, 500);\n    // }\n    // Remove existing graphs\n    removeExistingGraphs();\n    // Gets hashtag array on each partner page via team.html\n    getGroupActivityStats(PT.iso3);\n\n    showMoreContributions();\n  });\n}\n\n// Returns svg link to Missing Maps user endpoint\nfunction generateUserUrl(userName) {\n  const userUrl =\n    \"http://www.missingmaps.org/users/#/\" +\n    userName.replace(/\\s+/g, \"-\").toLowerCase();\n  return `<a xlink:href=\"${userUrl}\" target=\"_blank\" style=\"text-decoration:none\">${userName}</a>`;\n}\n\nfunction getUserActivityStats(countryId) {\n  const url = `https://osm-stats-production-api.azurewebsites.net/countries/${countryId}/users`;\n  $.getJSON(url, function(userData) {\n    if (userData.length !== 0) {\n      const totalSum = Object.keys(userData)\n        .map(function(user) {\n          const totalEdits = Math.round(Number(userData[user].all_edits));\n          return {\n            name: generateUserUrl(userData[user].name),\n            value: totalEdits\n          };\n        })\n        .sort((a, b) => b.value - a.value);\n\n      // For each user, sum the total building edits\n      const bldngSum = Object.keys(userData)\n        .map(function(user) {\n          const bldngEdits = Math.round(\n            Number(userData[user].building_count_add)\n          );\n          return {\n            name: generateUserUrl(userData[user].name),\n            value: bldngEdits\n          };\n        })\n        .sort((a, b) => b.value - a.value);\n\n      // For each user, sum the total road kilometers edited\n      const roadsSum = Object.keys(userData)\n        .map(function(user) {\n          const roadsEdits = Math.round(Number(userData[user].road_km_add));\n          return {\n            name: generateUserUrl(userData[user].name),\n            value: roadsEdits\n          };\n        })\n        .sort((a, b) => b.value - a.value);\n\n      // Spawn a chart function with listening events for each of the metrics\n      var c1 = new Barchart(totalSum, \"#Team-User-Total-Graph\");\n      var c2 = new Barchart(bldngSum, \"#Team-User-Bldng-Graph\");\n      var c3 = new Barchart(roadsSum, \"#Team-User-Roads-Graph\");\n\n      const moreBtn = $(\".btn.invert-btn-grn.teams-btn\");\n      if (totalSum.length > 10) {\n        moreBtn.css(\"display\", \"inline\").animate({ opacity: 1 }, 500);\n      } else {\n        moreBtn.css(\"display\", \"inline\").animate({ opacity: 0 }, 500);\n      }\n\n      // On window resize, run window resize function on each chart\n      d3.select(window).on(\"resize\", function() {\n        c1.resize();\n        c2.resize();\n        c3.resize();\n      });\n    }\n  });\n}\n\n// Returns svg link to Missing Maps leaderboard endpoint\nfunction generateHashtagUrl(hashtag) {\n  const hashtagUrl = \"http://www.missingmaps.org/leaderboards/#/\" + hashtag;\n  return `<a xlink:href=\"${hashtagUrl}\" target=\"_blank\" style=\"text-decoration: none\">#${hashtag}</a>`;\n}\n\n// populate 'teams' graphs, which show activity per hashtag\nfunction getGroupActivityStats(countryId) {\n  const url = `https://osm-stats-production-api.azurewebsites.net/countries/${countryId}/hashtags`;\n  $.getJSON(url, function(hashtagData) {\n    /*\n      For each hashtag, generate obj with link to hashtag's mm-leaderboards\n      page and the statistic of interest\n      ---\n      this is done in a reduce function w/the following steps\n      1) check to see if object has contents\n      2) get the statistic of interest, 'sum', rounded & as a Number\n      3) add to an acc list a) a link to hashtag on leaderboards and b) sum\n      4) sort the hashtags from largest to smallest 'sum' value\n      */\n    if (hashtagData.length !== 0) {\n      const totalSum = hashtagData\n        .reduce(function(acc, ht) {\n          if (!$.isEmptyObject(ht)) {\n            const sum = Math.round(Number(ht.all_edits));\n            acc.push({ name: generateHashtagUrl(ht.hashtag), value: sum });\n          }\n          return acc;\n        }, [])\n        .sort((a, b) => b.value - a.value);\n\n      const bldngSum = hashtagData\n        .reduce(function(acc, ht) {\n          if (!$.isEmptyObject(ht)) {\n            const sum =\n              Math.round(Number(ht.building_count_add)) +\n              Math.round(Number(ht.building_count_mod));\n            acc.push({ name: generateHashtagUrl(ht.hashtag), value: sum });\n          }\n          return acc;\n        }, [])\n        .sort((a, b) => b.value - a.value);\n\n      const roadsSum = hashtagData\n        .reduce(function(acc, ht) {\n          if (!$.isEmptyObject(ht)) {\n            const sum =\n              Math.round(Number(ht.road_km_add)) +\n              Math.round(Number(ht.road_km_add));\n            acc.push({ name: generateHashtagUrl(ht.hashtag), value: sum });\n          }\n          return acc;\n        }, [])\n        .sort((a, b) => b.value - a.value);\n\n      // Spawn a chart function with listening events for each of the metrics\n      var c1 = new Barchart(totalSum, \"#Team-User-Total-Graph\");\n      var c2 = new Barchart(bldngSum, \"#Team-User-Bldng-Graph\");\n      var c3 = new Barchart(roadsSum, \"#Team-User-Roads-Graph\");\n\n      const moreBtn = $(\".btn.invert-btn-grn.teams-btn\");\n      if (totalSum.length > 10) {\n        moreBtn.css(\"display\", \"inline\").animate({ opacity: 1 }, 500);\n      } else {\n        moreBtn.css(\"display\", \"inline\").animate({ opacity: 0 }, 500);\n      }\n      // On window resize, run window resize function on each chart\n      d3.select(window).on(\"resize\", function() {\n        c1.resize();\n        c2.resize();\n        c3.resize();\n      });\n    } else {\n      $(\".Team-User-Nav\").css(\"display\", \"none\");\n      $(\".Team-User-Stats\").css(\"display\", \"none\");\n      $(\".teams-more\").css(\"display\", \"none\");\n      $(\".teams-none\").css(\"display\", \"block\");\n      $(\".Team-User-Container h1\").css(\"text-align\", \"center\");\n    }\n  });\n}\n\nfunction Barchart(data, targetElement) {\n  // Setting margins and size using Bostock conventions for future\n  // ease of use, although currently leaving margins at 0\n  let margin = { top: 0, right: 0, bottom: 0, left: 0 };\n  var width = parseInt(d3.select(targetElement).style(\"width\"), 10);\n  width = width - margin.left - margin.right;\n  let height = 220;\n  let barPadding = 60 / data.length;\n  let barHeight =\n    (height - margin.top - margin.bottom) / data.length - barPadding;\n\n  // If more than 10 records...\n  if (data.length > 10) {\n    // ...freeze dynamic sizing of bars and begin expanding the svg height instead\n    barPadding = 60 / 10;\n    barHeight = (height - margin.top - margin.bottom) / 10 - barPadding;\n    height = height + (barPadding + barHeight) * (data.length - 10);\n    // ...enable \"Show More\" functionality; button appears which allows\n    // for panning up and down the length of svg bar graph\n    const offset = -((data.length - 10) * (barPadding + barHeight)) - 12;\n    let expanded = false;\n    $(\".teams-btn\")\n      .css(\"display\", \"initial\")\n      .click(function() {\n        const graphs = $(\".Team-User-Graph > svg\");\n        if (expanded === false) {\n          $(\".teams-btn\").html(\"SHOW INITIAL TEAMS\");\n          graphs.animate({ marginTop: offset }, 300);\n          expanded = true;\n        } else if (expanded === true) {\n          $(\".teams-btn\").html(\"SHOW MORE TEAMS\");\n          graphs.animate({ marginTop: 0 }, 300);\n          expanded = false;\n        }\n      });\n  }\n\n  // Define scales\n  const x = d3.scale\n    .linear()\n    .range([0, width])\n    .domain([0, d3.max(data, d => d.value)]);\n\n  // Create the chart\n  var chart = d3\n    .select(targetElement)\n    .append(\"svg\")\n    .style(\"width\", width + margin.left + margin.right + \"px\")\n    .style(\"height\", height + \"px\")\n    .append(\"g\")\n    .attr(\"transform\", \"translate(\" + [margin.left, margin.top] + \")\");\n\n  d3.select(chart.node().parentNode).style(\"height\", height + \"px\");\n\n  // Render the chart, add the set the bar groups\n  var bars = chart\n    .selectAll(\".bar\")\n    .data(data)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"bar\")\n    .attr(\"transform\", (d, i) => {\n      return `translate(0,${i * (barHeight + barPadding)})`;\n    });\n\n  // Add the bar rectangles\n  bars\n    .append(\"rect\")\n    .attr(\"class\", \"bars\")\n    .attr(\"height\", barHeight)\n    .attr(\"width\", d => x(d.value));\n\n  // Add the name labels\n  bars\n    .append(\"text\")\n    .attr(\"class\", \"Graph-Label-Name\")\n    .attr(\"x\", 5)\n    .attr(\"y\", barHeight / 2)\n    .attr(\"dy\", \".35em\")\n    .html(d => d.name)\n    .style(\"fill\", \"#606161\");\n\n  // Add the value labels\n  bars\n    .append(\"text\")\n    .attr(\"class\", \"Graph-Label-Value\")\n    .attr(\"x\", width - 20)\n    .attr(\"y\", barHeight / 2)\n    .attr(\"dy\", \".35em\")\n    .text(d => d.value.toLocaleString())\n    .attr(\"text-anchor\", \"end\")\n    .style(\"fill\", \"#606161\");\n\n  this.resize = function() {\n    // Recalculate width of chart\n    width = parseInt(d3.select(targetElement).style(\"width\"), 10);\n    width = width - margin.left - margin.right;\n\n    // Update svg size\n    d3.select(targetElement)\n      .select(\"svg\")\n      .style(\"width\", width + margin.left + margin.right + \"px\");\n\n    // Update the scale of chart\n    x.range([0, width]);\n\n    // Update the bar width\n    chart.selectAll(\"rect.bars\").attr(\"width\", d => x(d.value));\n\n    // Update the value text position\n    chart.selectAll(\"text.Graph-Label-Value\").attr(\"x\", width - 20);\n  };\n}\n\nfunction showUpdatesPlaceholder() {\n  if ($(\".Updates-Content\").length === 0) {\n    $(\".updates-null\").css(\"display\", \"block\");\n    $(\"#updates-h1\").css(\"text-align\", \"center\");\n  }\n}\n\n/* -------------------------------------------------------\n  --------------------- OSMCha ---------------------\n  -------------------------------------------------------*/\n\n// function setUserPic(userId) {\n//   // var component = this;\n//   $.get('http://api.openstreetmap.org/api/0.6/user/' + userId, function (data) {\n//     var localGenericUrl = 'http://www.missingmaps.org/users/assets/graphics/osm-user-blank.jpg';\n//     var url = '';\n//     var urls = [];\n//     // Check for img href in user profile\n//     var xml = $.parseXML(data),\n//     $xml = $( xml ),\n//     $img = $xml.find('img');\n//     $imgsrc = $img.find()\n//     var urlBegin = xmlString.split('<img href=\"')[1];\n//     // If no img href, set state to the local generic image\n//     // (user's profile pic is generic)\n//     if (!urlBegin) {\n//       url = localGenericUrl;\n//       return url;\n//     } else {\n//       url = urlBegin.substring(0, urlBegin.indexOf('\"/>'));\n//       urls = url.split('&amp;d=');\n//       if (urls.length < 2) {\n//         // If one img href, use the 'large' version to set\n//         // state (it is the user's custom OSM profile pic)\n//         url = url.replace('/original/', '/large/');\n//         return url;\n//       } else {\n//         // If >one img href, pic is from Gravatar, so check if\n//         // user has custom or generic pic and set state to local\n//         // generic or 128px version of their pic accordingly.\n//         url = urls[0].replace('?s=256', '?s=128');\n//         return url;\n//       }\n//     }\n//\n//     $(`#mapper-${userId}`).attr(\"src\", url);\n//   });\n// }\n\n// function addeditsMap (edits) {\n//    const blah = edits;\n//     // Remove loading spinners before placing map\n//     // $(`#Map-Box-${blah.id}`).empty();\n//\n//     // Initialize map\n//     console.log(`#Map-Box-${blah.id}`);\n//     const map = L.map(`#Map-Box-${blah.id}`,\n//     {zoomControl: false}).setView([38.889931, -77.009003], 13);\n//\n//     // Add tile layer\n//     L.tileLayer(mbBasemapUrl + '?access_token=' + mbToken, {\n//       attribution: '<a href=\"http://mapbox.com\">Mapbox</a>'\n//     }).addTo(map);\n//\n//     // Remove 'Leaflet' attribution\n//     map.attributionControl.setPrefix('');\n//\n//     // Add feature layer\n//     const featureLayer = L.geoJson(blah.geom, {\n//       onEachFeature: onEachFeature\n//     }).addTo(map);\n//\n//     // Fit to feature layer bounds\n//     map.fitBounds(featureLayer.getBounds());\n//\n//     // Disable drag and zoom handlers\n//     map.dragging.disable();\n//     map.touchZoom.disable();\n//     map.doubleClickZoom.disable();\n//     map.scrollWheelZoom.disable();\n//     map.keyboard.disable();\n//     if (map.tap) map.tap.disable();\n//   }\n\nfunction makeValidation(userList) {\n  const users = _.uniqBy(userList.features, \"properties.uid\");\n  const mappercount = users.length;\n\n  $(\"#Mapper-Count\").html(mappercount);\n\n  users.forEach(function(features) {\n    const output = `<div class=\"column\">\n        <div class=\"card\">\n                 <div class=\"center\" style=\"\">\n                    <img class=\"user-circle mapper-${\n                      features.properties.uid\n                    }\" style=\"width:50px;margin-top:5px;\" src=\"http://www.missingmaps.org/users/assets/graphics/osm-user-blank.jpg\" />\n                    <h6><a href=\"http://www.missingmaps.org/users/#/${\n                      features.properties.user\n                    }\">${features.properties.user}</a></h4>\n                  </div>\n                  <!--<div id=\"Map-Box-${features.id}\" class=\"column small-2\">\n                  </div>-->\n            <div class=\"\">\n                <h6>Last Edit: ${features.properties.date.slice(0, 10)}</h6>\n                <h6>Edits: <span class=\"badge success edits\">${\n                  features.properties.create\n                }</span><span class=\"badge warning edits\">${\n      features.properties.modify\n    }</span><span class=\"badge alert edits\">${\n      features.properties.delete\n    }</span></h6>\n\n                <!--<div class=\"map-box\">\n\n                </div>-->\n                <br>\n                <a class=\"btn btn-blue\" href=\"https://osmcha.mapbox.com/changesets/${\n                  features.id\n                }\">Review Edit<a>\n                <a class=\"btn btn-blue\" href=\"http://www.openstreetmap.org/message/new/${\n                  features.properties.user\n                }\">Say Hello<a>\n            </div>\n        </div>\n    </div>`;\n\n    $(\"#Validation-Data\").append(output);\n    // setUserPic(`${features.properties.uid}`);\n    // addeditsMap(features);\n  });\n}\n\nfunction getDate() {\n  let today = new Date();\n  let dd = today.getDate() - 7; //get new mappers from the past week\n  let mm = today.getMonth() + 1; //January is 0!\n  let yyyy = today.getFullYear();\n\n  if (dd < 10) {\n    dd = \"0\" + dd;\n  }\n\n  if (mm < 10) {\n    mm = \"0\" + mm;\n  }\n\n  return (today = yyyy + \"-\" + mm + \"-\" + dd);\n}\n\nfunction getValidation(bbox) {\n  const bbx = bbox.split(\",\");\n  let valDate = getDate();\n  let url = `https://osmcha.mapbox.com/api/v1/changesets/?page=1&page_size=15&order_by=-date&reasons=40&date__gte=${valDate}&in_bbox=${bbx[0]},${bbx[1]},${bbx[2]},${bbx[3]}`;\n\n  $.getJSON(url, function(data) {\n    makeValidation(data);\n  }).fail(function(err) {\n    console.warn(\"No New Mappers\", err);\n  });\n}\n\n/* !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n  ---------------------------------------------------------\n  --------------------- Setup Project ---------------------\n  -------------------------------------------------------*/\n// Global Mapbox variables\nconst mbToken =\n  \"pk.eyJ1IjoiZGV2c2VlZCIsImEiOiJnUi1mbkVvIn0.018aLhX0Mb0tdtaT2QNe2Q\";\nconst mbBasemapUrl = \"https://api.mapbox.com/v4/mapbox.light/{z}/{x}/{y}.png\";\n\nif (PT.name !== \"Microsites\") {\n  showUpdatesPlaceholder();\n  // Populate the primary stats in hero via Missing Maps API\n  getPrimaryStats(PT.iso3);\n  // Populate initial groups graph via Missing Maps API\n  getGroupActivityStats(PT.iso3);\n  // Populate project carousel via HOTOSM Tasking Manager API\n  getProjects(PT.hotProjects);\n  // Populate events section with upcoming events\n  generateEvents(PT.calendar);\n  // Populate OSMCha section with feed\n  getValidation(PT.bbox);\n  // setupGraphs\n  setupGraphs();\n}\n"],"sourceRoot":"/source/"}